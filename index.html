<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Block Studio</title>

<style>
body{
  margin:0;
  display:flex;
  height:100vh;
  font-family:Arial;
}

#sidebar{
  width:260px;
  background:#222;
  color:white;
  padding:10px;
  overflow-y:auto;
}

#workspace{
  flex:1;
  padding:20px;
  background:#f4f4f4;
}

.category{
  margin-bottom:15px;
  background:#333;
  padding:8px;
}

.categoryHeader{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.blockButton{
  display:flex;
  justify-content:space-between;
  align-items:center;
  width:100%;
  margin-bottom:5px;
  padding:6px;
  border:none;
  cursor:pointer;
  color:white;
}

.smallBtn{
  background:red;
  border:none;
  color:white;
  cursor:pointer;
  padding:2px 6px;
}

.outputBlock{
  background:white;
  padding:10px;
  margin-bottom:8px;
  border-left:6px solid black;
}

input, select, button{
  width:100%;
  margin-bottom:6px;
  padding:6px;
}
</style>
</head>
<body>

<div id="sidebar">

<h2>Neue Kategorie</h2>
<input id="catName" placeholder="Name">
<input id="catColor" placeholder="Farbe (z.B. red oder #ff0000)">
<button onclick="addCategory()">Kategorie hinzufügen</button>

<hr>

<h2>Neuer Block</h2>
<input id="blockText" placeholder="Text vom Block">
<select id="categorySelect"></select>
<button onclick="addBlock()">Block hinzufügen</button>

<hr>

<div id="categories"></div>

</div>

<div id="workspace">
<h2>Arbeitsbereich</h2>
<div id="output"></div>
<button onclick="clearWorkspace()">Alles löschen</button>
</div>

<script>
let categories = JSON.parse(localStorage.getItem("cats")) || [];

function save(){
  localStorage.setItem("cats", JSON.stringify(categories));
}

function updateCategorySelect(){
  const select=document.getElementById("categorySelect");
  select.innerHTML="";
  categories.forEach((cat,index)=>{
    const option=document.createElement("option");
    option.value=index;
    option.textContent=cat.name;
    select.appendChild(option);
  });
}

function renderCategories(){
  const container=document.getElementById("categories");
  container.innerHTML="";

  categories.forEach((cat,index)=>{
    const div=document.createElement("div");
    div.className="category";

    const header=document.createElement("div");
    header.className="categoryHeader";

    const title=document.createElement("strong");
    title.textContent=cat.name;

    const delBtn=document.createElement("button");
    delBtn.textContent="X";
    delBtn.className="smallBtn";
    delBtn.onclick=()=>{
      if(confirm("Kategorie löschen?")){
        categories.splice(index,1);
        save();
        renderCategories();
      }
    };

    header.appendChild(title);
    header.appendChild(delBtn);
    div.appendChild(header);

    cat.blocks.forEach((block,bIndex)=>{
      const btn=document.createElement("div");
      btn.className="blockButton";
      btn.style.background=cat.color;

      const span=document.createElement("span");
      span.textContent=block;
      span.style.cursor="pointer";
      span.onclick=()=>{
        addToWorkspace(block,cat.color);
      };

      const blockDel=document.createElement("button");
      blockDel.textContent="X";
      blockDel.className="smallBtn";
      blockDel.onclick=()=>{
        categories[index].blocks.splice(bIndex,1);
        save();
        renderCategories();
      };

      btn.appendChild(span);
      btn.appendChild(blockDel);
      div.appendChild(btn);
    });

    container.appendChild(div);
  });

  updateCategorySelect();
}

function addCategory(){
  const name=document.getElementById("catName").value;
  const color=document.getElementById("catColor").value || "blue";
  if(!name) return;

  categories.push({
    name:name,
    color:color,
    blocks:[]
  });

  save();
  renderCategories();
}

function addBlock(){
  const text=document.getElementById("blockText").value;
  const index=document.getElementById("categorySelect").value;
  if(!text || index===null) return;

  categories[index].blocks.push(text);

  save();
  renderCategories();
}

function addToWorkspace(text,color){
  const div=document.createElement("div");
  div.className="outputBlock";
  div.style.borderColor=color;
  div.innerText=text;
  document.getElementById("output").appendChild(div);
}

function clearWorkspace(){
  document.getElementById("output").innerHTML="";
}

renderCategories();
</script>

</body>
</html>
